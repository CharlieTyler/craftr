<% if user_signed_in? %>
  <% if current_user.favourited_product?(product) %>
    <%= link_to product_favourite_product_path(current_user.user_favourite_products.find_by(product: product), product_id: product.id), class: "btn btn-primary favourite-button col-10 offset-1", method: :delete, remote: true do %>
      <i class="fa fa-heart" aria-hidden="true"></i> Favourited
    <% end %>
  <% else %>
    <div class = "col-12">
      <p>Craftr will be transactional soon! Favourite a product so we can let you know when you can buy it!</p> 
    </div>
    <%= link_to product_favourite_products_path(product_id: product.id), class: "btn btn-primary favourite-button col-10 offset-1", method: :post, remote: true do %>
      <i class="fa fa-heart-o" aria-hidden="true"></i> Favourite
    <% end %>
  <% end %>
<% else %>
  <%= link_to "Sign up to favourite", new_user_registration_path, class: "btn btn-primary col-10 offset-1" %>
<% end %>

<script>
  $('.favourite-button').click(function() {
    $('.favourite-button').html('<i class="fa fa-spinner fa-pulse" aria-hidden="true"></i>');
  });
</script>